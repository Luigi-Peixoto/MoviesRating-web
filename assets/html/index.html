<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/header.css">
    <link rel="stylesheet" href="../css/navbar.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/footer.css">
    <link rel="stylesheet" href="../css/container.css">
    <script type="module" src="../script/index.js"></script>
    <script type="module" src="../script/login.js"></script>
    <title>Rate - Movie Rating Website</title>
</head>

<body>
    
    <header>
        <img src="../images/Logo.png" alt="Logo" id="logo">
        <div id="search-content" style="visibility:hidden;">
            <form id="searchbar">
                <span class="searchbar-icon material-symbols-outlined">Search</span>
                <input type="search" class="searchbar-text" placeholder="Pesquisar filme ou série...">
            </form>
            <div id="searchResults"></div>
        </div>
        
        <span id="authentication">
            
            <div id="login-dropdown">
                <iframe src="../html/login.html" title="Rate - Login Page" style="height: 120px;"></iframe>
            </div>
            
            <button id="login-dropdown-button" class="buttonAuthentication">Login</button>
            <a href="/register" class="buttonAuthentication special">Register</a>
        </span>
    </header>
    
    <nav>
        <ul id="navbar-list">
            <li class="navbar-item"><a href="/">Início</a></li>
            <li class="navbar-item"><a href="/movies">Filmes</a></li>
            <li class="navbar-item"><a href="/shows">Séries</a></li>
            <li class="navbar-item"><a href="/rate">Avaliar</a></li>
        </ul>
    </nav>
    
    <main>
        
        <h1>Não sabe o que assistir?</h1>
        <h3>Filmes mais bem avaliados pelos membros do site! Você não vai se arrepender..</h3>
        
        <article id="top-content"></article>
    </main>

    <footer>
        <p>Por Elson Freire e Luigi Soares - &#169 Todos os direitos reservados</p>
    </footer>
</body>
<script>
document.addEventListener("DOMContentLoaded", function() {
    const searchInput = document.querySelector('#searchbar-text');
    const searchResults = document.querySelector('#searchResults');
    searchInput.addEventListener('keyup', function() {
    const query = searchInput.value.trim(); // Obter o valor do campo de entrada

    // Enviar a solicitação para o servidor apenas se houver uma consulta válida
    if (query.length > 0) {
        const xhr = new XMLHttpRequest();
        xhr.open('GET', `/search?q=${query}`, true);

        xhr.onload = function() {
        if (this.status === 200) {
            const results = JSON.parse(this.responseText);

            // Limpar os resultados anteriores
            searchResults.innerHTML = '';

            // Exibir os novos resultados
            results.forEach(function(result) {
            const div = document.createElement('div');
            div.innerHTML = `<h2>${result.title}</h2><p>${result.description}</p>`;
            searchResults.appendChild(div);
            });
        }
        }

        xhr.send();
    } else {
        // Se o campo estiver vazio, limpar os resultados
        searchResults.innerHTML = '';
    }
    });
});
</script>
</html>